@model BookMart.Models.Order
@using System.Globalization

@{
    ViewData["Title"] = "Order Confirmation";
    Layout = "~/Views/Shared/userPaymentSuccesfullLayout.cshtml";
}

<div class="container mt-5 pt-5">
    <div class="success-animation">
        <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
            <circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>
            <path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
        </svg>
        <h2 class="mt-4">Order Placed Successfully!</h2>
        <p class="text-muted">Thank you for shopping with us.</p>
    </div>

    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-white py-3">
                    <div class="d-flex justify-content-between align-items-center">
                        <h4 class="mb-0">Order Details</h4>
                        <span class="badge bg-primary">Order #@Model.OrderID</span>
                    </div>
                </div>
                <div class="card-body">
                    <!-- Order Status -->
                    <div class="mb-4">
                        <h5 class="mb-3">Order Status</h5>
                        <div class="alert alert-success">
                            <i class="fas fa-check-circle me-2"></i>Your order has been confirmed
                        </div>
                    </div>

                    <!-- Delivery Address -->
                    <div class="mb-4">
                        <h5 class="mb-3">Delivery Address</h5>
                        <p class="mb-1">@Model.ShippingFirstName @Model.ShippingLastName</p>
                        <p class="mb-1">@Model.ShippingAddressLine1</p>
                        @if (!string.IsNullOrWhiteSpace(Model.ShippingAddressLine2))
                        {
                            <p class="mb-1">@Model.ShippingAddressLine2</p>
                        }
                        <p class="mb-1">@Model.ShippingCity, @Model.ShippingState @Model.ShippingPinCode</p>
                        <p class="mb-0">Phone: @Model.ShippingPhone</p>
                    </div>

                    <!-- Order Items -->
                    <div class="mb-4">
                        <h5 class="mb-3">Order Items</h5>
                        @foreach (var item in Model.OrderItems ?? Enumerable.Empty<OrderItem>())
                        {
                            <div class="d-flex align-items-center mb-3">
                                <img src="@item.Book?.CoverImageURL" alt="@item.Book?.Title" class="rounded" style="width: 50px; height: 70px; object-fit: cover;">
                                <div class="ms-3">
                                    <h6 class="mb-0">@item.Book?.Title</h6>
                                    <small class="text-muted">Qty: @item.Quantity × ₹@item.Price.ToString("F2", CultureInfo.InvariantCulture)</small>
                                </div>
                                <span class="ms-auto">₹@(item.Quantity * item.Price).ToString("F2", CultureInfo.InvariantCulture)</span>
                            </div>
                        }
                    </div>

                    <!-- Cost Breakdown -->
                    <div class="border-top pt-3">
                        <div class="d-flex justify-content-between mb-2">
                            <span>Subtotal</span>
                            <span>₹@Model.SubTotal.ToString("F2", CultureInfo.InvariantCulture)</span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Shipping</span>
                            <span>₹@Model.ShippingCost.ToString("F2", CultureInfo.InvariantCulture)</span>
                        </div>
                        @* <div class="d-flex justify-content-between mb-2"> *@
                        @*     <span>Tax</span> *@
                        @*     <span>₹@Model.TaxAmount.ToString("F2", CultureInfo.InvariantCulture)</span> *@
                        @* </div> *@
                        <hr>
                        <div class="d-flex justify-content-between">
                            <strong>Total</strong>
                            <strong class="h4">₹@Model.TotalAmount.ToString("F2", CultureInfo.InvariantCulture)</strong>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="d-flex justify-content-between">
                <a href="@Url.Action("UserHome", "User")" class="btn btn-outline-primary">
                    <i class="fas fa-shopping-cart me-2"></i>Continue Shopping
                </a>
                <a href="@Url.Action("UserOrder", "User")" class="btn btn-primary">
                    <i class="fas fa-box me-2"></i>View All Orders
                </a>
            </div>
        </div>
    </div>
</div>